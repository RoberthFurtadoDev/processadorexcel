# Processador de Dados de Im√≥veis

Sistema de automa√ß√£o para extra√ß√£o e formata√ß√£o de dados de im√≥veis a partir de planilhas Excel, gerando sa√≠da padronizada com c√©lulas mescladas e centralizadas.

## üìã Descri√ß√£o

Este projeto foi desenvolvido para atender uma demanda espec√≠fica da empresa, automatizando o processamento manual de dados de im√≥veis. A solu√ß√£o reduz significativamente o tempo operacional e elimina perdas financeiras decorrentes de erros humanos no tratamento de grandes volumes de dados.

## üöÄ Tecnologias

- **Python 3.13+**
- **openpyxl** - Manipula√ß√£o de arquivos Excel (.xlsx)
- **Arquitetura Hexagonal** - Separa√ß√£o em camadas (dom√≠nio, aplica√ß√£o, infraestrutura)

## üìÅ Estrutura do Projeto

processar_refatorado/
    domain/
        __init__.py
        entities.py          # Entidades de dom√≠nio (Imovel)
        services.py          # Servi√ßos (formata√ß√£o de n√∫meros e r√≥tulos)
    
    application/
        __init__.py
        use_cases.py         # Caso de uso: ProcessarImoveisUseCase
    
    infrastructure/
        __init__.py
        excel_reader.py      # Adaptador de leitura Excel
        excel_writer.py      # Adaptador de escrita Excel
    
    config.py                # Configura√ß√µes centralizadas
    main.py                  # Ponto de entrada da aplica√ß√£o
    .gitignore               # Arquivos ignorados pelo Git
    README.md                # Documenta√ß√£o completa do projeto
    requirements.txt         # Depend√™ncias Python (openpyxl)
     

## ‚öôÔ∏è Instala√ß√£o

### Pr√©-requisitos
- Python 3.13 ou superior
- pip

### Passos
- Clone o reposit√≥rio:
- git clone https://github.com/seu-usuario/processar-imoveis.git
- cd processar-imoveis

- Crie um ambiente virtual (recomendado):
- python -m venv venv
- source venv/bin/activate # Linux/Mac
- venv\Scripts\activate # Windows

- Instale as depend√™ncias:
- pip install -r requirements.txt

### Execu√ß√£o b√°sica
- python main.py "Teste tit2.xlsx" "Planilha1"

### Par√¢metros
- **Argumento 1** (opcional): Caminho do arquivo Excel de entrada
- Padr√£o: `Teste tit2.xlsx`
- **Argumento 2** (opcional): Nome da planilha a processar
- Padr√£o: `Planilha1`

### Vari√°veis de ambiente
- Crie um arquivo `.env` (j√° ignorado no `.gitignore`) para sobrescrever configura√ß√µes:

- INPUT_FILE=seu_arquivo.xlsx
- INPUT_SHEET=NomeDaPlanilha
- OUTPUT_FILE=saida_customizada.xlsx

### Exemplo de sa√≠da
- O script gera um arquivo `dados_formatados.xlsx` com:
- Uma √∫nica planilha "Registros"
- Cada im√≥vel em uma c√©lula da coluna A (A1, A2, A3, ...)
- Texto centralizado com quebra de linha autom√°tica
- Bordas ao redor de cada "card"
- Formata√ß√£o brasileira: v√≠rgula como separador decimal, m¬≤ para √°reas

## üìä Formato de Entrada

A planilha de entrada deve seguir este layout (√≠ndices 0-based):

| Coluna | √çndice | Descri√ß√£o |
|--------|--------|-----------|
| A | 0 | Empreendimento |
| B | 1 | Tipo do im√≥vel |
| D | 3 | √Årea total |
| G | 6 | √Årea privativa |
| J | 9 | √Årea do terreno |
| L | 11 | Quantidade de quartos |
| M | 12 | R√≥tulo "quartos" |
| N | 13 | Vaga (texto livre) |
| ... | ... | ... |
| Y | 24 | Descri√ß√£o adicional |
| AA | 26 | IPTU |
| AC | 28 | Matr√≠cula |
| AE | 30 | Of√≠cio |

## üèóÔ∏è Arquitetura

O projeto segue princ√≠pios da **Arquitetura Hexagonal**:

- **Dom√≠nio** (`domain/`): Regras de neg√≥cio puras, sem depend√™ncias externas
- **Aplica√ß√£o** (`application/`): Orquestra√ß√£o dos casos de uso
- **Infraestrutura** (`infrastructure/`): Adaptadores para Excel (I/O)
- **Config** (`config.py`): Configura√ß√µes centralizadas e injet√°veis

### Benef√≠cios
- ‚úÖ Testabilidade: camadas isoladas facilitam mocks
- ‚úÖ Manutenibilidade: mudan√ßas localizadas
- ‚úÖ Escalabilidade: f√°cil adicionar novos adaptadores (JSON, CSV, DB)

## ü§ù Contribuindo

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/MinhaFeature`)
3. Commit suas mudan√ßas (`git commit -m 'feat: adiciona nova feature'`)
4. Push para a branch (`git push origin feature/MinhaFeature`)
5. Abra um Pull Request

### Conven√ß√£o de commits
- `feat:` nova funcionalidade
- `fix:` corre√ß√£o de bug
- `docs:` apenas documenta√ß√£o
- `refactor:` refatora√ß√£o sem mudar comportamento
- `test:` adiciona ou corrige testes